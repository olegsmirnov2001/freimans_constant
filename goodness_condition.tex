\subsection{Sufficient conditions of goodness}

\subsubsection{Results}

A horizontal rectangle $\D$ is good, if
\begin{equation}\label{goodness_condition}
	\dfrac{\D_1}{\D_2} <
	\left\{\begin{array}{ll}
		3.8, & i_1 \equiv i_2 \pmod 2,\\
		3.43, & i_1 \not\equiv i_2 \pmod 2.
	\end{array}\right.
\end{equation}

\subsubsection{Universal $2,9$ bound}

Now let's introduce some sufficient conditions for rectangle to be good.

Remind that we suppose $|\D_1| \geqslant |\D_2|$, which means that

\begin{equation*}
	q
	\dfrac{1 + p \T{1}}{1 + p' \T{1}}
	\dfrac{1 + p \T{95}}{1 + p' \T{95}} \leqslant 1.
\end{equation*}

\begin{designation}
	For given continuations $\T\g$ and $\T\d$, denote by $\g$ and $\d$ the resulting continued fractions:
	\begin{gather*}
		\g = [0; a_{-1}, ..., a_{i_1}, \frac{1}{\T\g}], \\
		\d = [0; a_{1}, ..., a_{i_2}, \frac{1}{\T\d}].
	\end{gather*}

	As stated in \oldref{sbsc:introductory},
	$\g$'s correspond to the lhs of $\M$, and $\d$'s correspond to the rhs of $\M$.
	
	Variables $\Th$ will be taken from the Figure \oldref{fg:table-thetas}
	and will be specified in each case separately.
\end{designation}

If rectangle is good, then \ref{eq:goodness-in-deltas} should take place:

\begin{equation}\label{eq:goodness-in-deltas}
	\g' - \g'' < |\d' - \d''|,
\end{equation}

where
$\T{\g'} = \T{66}$,
$\T{\g''} = \T{63}$,
$\T{\d'} = \T{90}$,
$\T{\d''} = \T{30}$.

Inequality \ref{eq:goodness-in-deltas} transforms into

\begin{equation}\label{12.2}
	0,313 <
	q
	\dfrac{1 + p \T{63}}{1 + p' \T{30}}
	\dfrac{1 + p \T{66}}{1 + p' \T{90}}.
\end{equation}

Suppose that

\begin{equation}\label{goodness_condition_2,9}
	\dfrac{\D_1}{\D_2} < 2,9,
\end{equation}

which is equivalent to

\begin{equation}
	\dfrac{1}{q}
	\dfrac{1 + p' \T{1}}{1 + p \T{1}}
	\dfrac{1 + p' \T{95}}{1 + p \T{95}}
	<
	2,9.
\end{equation}

Then \ref{12.2} takes place. Indeed, it is so, if

\begin{equation*}
	\dfrac{1}{2,9}
	\dfrac{1 + p' \T{1}}{1 + p \T{1}}
	\dfrac{1 + p' \T{95}}{1 + p \T{95}}
	>
	0,313
	\dfrac{1 + p' \T{30}}{1 + p \T{63}}
	\dfrac{1 + p' \T{90}}{1 + p \T{66}}.
\end{equation*}

or, equivalent,

\begin{equation*}
	1,1
	>
	\dfrac{1 + p \T{1}}{1 + p \T{63}}
	\dfrac{1 + p \T{95}}{1 + p \T{66}}
	\dfrac{1 + p' \T{30}}{1 + p' \T{1}}
	\dfrac{1 + p' \T{90}}{1 + p' \T{95}},
\end{equation*}

which is checked directly.

Condition \ref{goodness_condition_2,9} is sufficient for rectangle to be good,
regardless of the parity of $i_1$ and $i_2$ and the left or right shortness or normalness of rectangle.

\subsubsection{Case $i_1 = i_2 \pmod 2$}

Now consider case $i_1 = i_2 \pmod 2$.

\pic[0.5]{pic4}

We will suppose case $a_{i_2} = 1$, $a_{i_2 - 1} = 3$ doesn't take place.

We can substitute the folliwing $\g$'s and $\d$'s
into \ref{eq:goodness-in-deltas}:
%
\Ts{66}{63}{90}{3}

and instead of \ref{12.2} we will get

\begin{equation}\label{12.5}
	0,253 < q
	\dfrac{1 + p \T{63}}{1 + p' \T{3}}
	\dfrac{1 + p \T{66}}{1 + p' \T{90}}.
\end{equation}

This choise of $\T{\g'}$ and $\T{\d''}$ is fine,
if the following inequality takes place:

\begin{equation}\label{goodness_condition_1,4}
	\d' - \d'' > 1,4 (\g' - \g''),
\end{equation}

where 
\begin{equation*}
	\T{\g'} = \T{68},\;
	\T{\g''} = \T{65},\;
	\T{\d'} = \T{28},\;
	\T{\d''} = \T{1},
\end{equation*}

so we can rewrite \ref{goodness_condition_1,4} as

\begin{equation}\label{12.7}
	0,253 < q
	\dfrac{1 + p \T{65}}{1 + p' \T{1}}
	\dfrac{1 + p \T{68}}{1 + p' \T{28}}.
\end{equation}

We can notice that \ref{12.7} follows from \ref{12.5}. Indeed, that follows from the inequality

\begin{equation*}
	0,253
	\dfrac{1 + p' \T{3}}{1 + p' \T{63}}
	\dfrac{1 + p \T{90}}{1 + p \T{66}}
	>
	0,269
	\dfrac{1 + p' \T{1}}{1 + p' \T{65}}
	\dfrac{1 + p \T{28}}{1 + p \T{68}},
\end{equation*}

or inequality

\begin{equation*}
	\dfrac{1 + p \T{65}}{1 + p \T{63}}
	\dfrac{1 + p \T{68}}{1 + p \T{66}}
	\dfrac{1 + p' \T{3}}{1 + p' \T{1}}
	\dfrac{1 + p' \T{90}}{1 + p' \T{28}}
	>
	1,064.
\end{equation*}

Overall, we proved that \ref{12.5} is enough for rectangle to be good.

Suppose that

\begin{equation}\label{goodness_condition_3,8}
	\dfrac{\D_1}{\D_2} < 3,8,
\end{equation}

or

\begin{equation*}
	\dfrac{1}{q}
	\dfrac{1 + p' \T{1}}{1 + p \T{1}}
	\dfrac{1 + p' \T{95}}{1 + p \T{95}}
	<
	3,8.
\end{equation*}

Then \ref{12.5} takes place. Indeed, it is so, if

\begin{equation*}
	\dfrac{1}{3,8}
	\dfrac{1 + p' \T{1}}{1 + p' \T{1}}
	\dfrac{1 + p \T{95}}{1 + p \T{95}}
	>
	0,253
	\dfrac{1 + p' \T{3}}{1 + p' \T{63}}
	\dfrac{1 + p \T{90}}{1 + p \T{66}}.
\end{equation*}

The last inequality is transformed into

\begin{equation*}
	1,04
	>
	\dfrac{1 + p' \T{3}}{1 + p' \T{1}}
	\dfrac{1 + p' \T{90}}{1 + p' \T{95}}
	\dfrac{1 + p \T{1}}{1 + p \T{63}}
	\dfrac{1 + p \T{95}}{1 + p \T{66}},
\end{equation*}

which is easily checked.

\subsubsection{Case $i_1 \ne i_2 \pmod 2$}

Now consider case $i_1 \ne i_2 \pmod 2$
and, again, case $a_{i_2} = 1$, $a_{i_2 - 1} = 3$
doesn't take place.
Suppose that $i_1$ is even.

\pic[0.6]{pic5}

Taking
\begin{equation*}
	\T{\g'} = \T{66},\;
	\T{\g''} = \T{59},\;
	\T{\d'} = \T{3},\;
	\T{\d''} = \T{90},
\end{equation*}

rewrite \ref{eq:goodness-in-deltas} as

\begin{equation}\label{12.9}
	0,2885
	<
	q
	\dfrac{1 + p \T{59}}{1 + p' \T{3}}
	\dfrac{1 + p \T{66}}{1 + p' \T{90}}.
\end{equation}

Suppose

\begin{equation}\label{goodness_condition_3,43}
	\dfrac{\D_1}{\D_2} < 3,43
\end{equation}

or

\begin{equation*}
	\dfrac{1}{q}
	\dfrac{1 + p' \T{1}}{1 + p \T{1}}
	\dfrac{1 + p' \T{95}}{1 + p \T{95}}
	<
	3,43.
\end{equation*}

Then \ref{12.9} takes place. Indeed, it is so, if

\begin{equation*}
	\dfrac{1}{3,43}
	\dfrac{1 + p' \T{1}}{1 + p \T{1}}
	\dfrac{1 + p' \T{95}}{1 + p \T{95}}
	>
	0,2885
	\dfrac{1 + p' \T{3}}{1 + p \T{59}}
	\dfrac{1 + p' \T{90}}{1 + p \T{66}}.
\end{equation*}

or

\begin{equation*}
	1,0105
	>
	\dfrac{1 + p' \T{3}}{1 + p' \T{1}}
	\dfrac{1 + p' \T{90}}{1 + p' \T{95}}
	\dfrac{1 + p \T{1}}{1 + p \T{59}}
	\dfrac{1 + p \T{95}}{1 + p \T{66}},
\end{equation*}

increasing the right part, obtain

\begin{equation*}
	1,0105
	>
	0,9896
	\dfrac
	{1 + p \cdot 1,0551 + p^2 \cdot 0,20875}
	{1 + p \cdot 0,983 + p^2 \cdot 0,237},
\end{equation*}

which is easily checked.
